[core]
	excludesfile = ~/.gitignore_global
	editor = emacsclient

[user]
	name = Masafumi Koba
	email = ybiquitous@gmail.com
	signingkey = 60F83A73EFECA4BD

# Inspired by
# - https://github.com/GitAlias/gitalias
# - http://gggritso.com/human-git-aliases
[alias]

	# Shortcut (most frequent commands)
	a = add
	b = branch --all
	c = commit
	ca = commit --all
	d = diff
	g = grep
	l = log
	ls = ls-files
	s = status

	# Branch
	branch-name = rev-parse --abbrev-ref HEAD
	delete-branch = branch --delete
	master = checkout master
	new-branch = checkout -b
	rename-branch = branch --move
	switch = !"f() { git --no-pager branch --all --list $1 | xargs git checkout; }; f"
	switch-remote = !"f() { git --no-pager branch --remotes --list $1 | xargs git checkout --track; }; f"
	prune-branches = !"git remote prune $(git origin)"
	# https://stackoverflow.com/questions/28666357/git-how-to-get-default-branch
	default-branch = !"git symbolic-ref  --short refs/remotes/origin/HEAD | sed 's|^origin/||'"

# Tag
	delete-tag = !"f() { git push --delete $(git origin) $1 && git tag --delete $1; }; f"

	# Info
	detail = show --pretty=full --show-signature
	graph = log --graph
	oneline = log --oneline
	precommit = diff --staged
	precommit-files = diff --staged --name-only
	recent = log -10
	summary = status --short --untracked-files
	origin = !"git remote | head -1"
	hash = !"f() { git log -${1:-1} --format='%H' | tail -1; }; f"
	diff-ignore-spaces = diff --ignore-space-change

	# Grep
	grep-group = grep --line-number --heading --break
	grep-word = grep --word-regexp

	# Config
	edit-config = config --edit
	edit-config-global = edit-config --global
	list-config = config --list
	list-config-global = list-config --global

	# Undo
	amend = commit --amend
	discard = checkout --
	fixup = commit --fixup HEAD
	uncommit = reset --soft HEAD~1
	unstage = reset HEAD
	unstash = stash pop
	rewrite = !"f() { git rebase --interactive \"HEAD~$1\"; }; f"

	# Push
	publish = !"git push --set-upstream $(git origin) $(git branch-name)"
	force-push = push --force-with-lease

	# Clean
	cleanest = clean --force -dx

	# Sync fork
	# https://help.github.com/articles/configuring-a-remote-for-a-fork/
	set-upstream = !"f() { if [ -n \"$1\" ]; then git remote add upstream $1; else echo 'usage: git set-upstream <https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY.git>' && exit 1; fi; }; f"
	# https://help.github.com/articles/syncing-a-fork/
	sync-fork = !"git fetch upstream && git checkout $(git default-branch) && git merge upstream/$(git default-branch) && git push && git pull --prune"

	# Plural
	aliases = !"git config --get-regexp '^alias\\.' | cut -c 7- | sed 's/ / = /'"
	branches = branch --all
	contributors = shortlog --summary --numbered --no-merges
	remotes = remote --verbose
	stashes = stash list
	tags = tag
	tags-remote = ls-remote --tag

[format]
	pretty = %C(auto)%h %Creset%<(72,trunc)%s %Cgreen%<(16,trunc)%aN%Creset %ar%C(auto)%d

[color]
	ui = auto

[pager]
	diff = diff-highlight | less
	show = diff-highlight | less
	log = diff-highlight | less

[commit]
	verbose = true
	gpgSign = true

[diff]
	compactionHeuristic = true
	indentHeuristic = true
	algorithm = patience

[rebase]
	autosquash = true

[grep]
	lineNumber = true
